
&НаКлиенте
Процедура Перезвонить(Команда)
	
	ПростыеЗвонки_ОбщийМодуль_Клиент.Позвонить(НомерТелефона);
	
КонецПроцедуры

&НаКлиенте
Процедура СкопироватьВБуфер(Команда)
	
	HTML = Новый COMОбъект("htmlfile");
	HTML.parentWindow.clipboardData.setData("Text",НомерТелефона);
	
КонецПроцедуры

&НаКлиенте
Процедура НайтиВЯндекс(Команда)
	
	ПредставлениеНомера = СокрЛП(СтрЗаменить(НомерТелефона," ","+"));
	
	ЗапуститьПриложение("http://yandex.ru/yandsearch?text="+ПредставлениеНомера);
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	НомерТелефона = Параметры.НомерТелефона;

	Местонахождение = "";
	ПредставлениеНомера = ПростыеЗвонки_ОбщийМодуль_Сервер.ПолучитьПредставлениеНомераТелефона(НомерТелефона,Местонахождение);
	
	
	НомерТелефона= ПредставлениеНомера;
	
	Если ПустаяСтрока(Местонахождение) Тогда
		
		Местонахождение = " не удалось определить";
		
	Иначе
		
		Местонахождение = " "+Местонахождение;
		
	КонецЕсли;
	
	Заголовок = "Входящий звонок в "+Формат(ТекущаяДата(),"ДЛФ=T");
	ЗаголовокЗвонка = "Записей с таким номером телефона не найдено";
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьПартнера(Команда)
	
	ПараметрФормыПартнера = Новый Структура;
	ПараметрФормыПартнера.Вставить("Ключ", Неопределено);
	
	СтруктураЗначенийЗаполнения = Новый Структура;
	СтруктураЗначенийЗаполнения.Вставить("ПростыеЗвонки_НомерТелефона",НомерТелефона);
		
	ПараметрФормыПартнера.Вставить("ЗначенияЗаполнения",СтруктураЗначенийЗаполнения);
	
	ПолучитьФорму("Справочник.Партнеры.ФормаОбъекта", ПараметрФормыПартнера).Открыть();
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьКонтрагента(Команда)
	
	ПараметрФормыКонтрагента = Новый Структура;
	ПараметрФормыКонтрагента.Вставить("Ключ", Неопределено);
	
	СтруктураЗначенийЗаполнения = Новый Структура;
	СтруктураЗначенийЗаполнения.Вставить("ПростыеЗвонки_НомерТелефона",НомерТелефона);
	
	// как бы передаем физ лицо, чтобы типовая обработка заполнения не сломалась
	СтруктураФизЛица = Новый Структура;
	СтруктураФизЛица.Вставить("Наименование","");
	
	СтруктураЗначенийЗаполнения.Вставить("ФизЛицо",СтруктураФизЛица);
	
	ПараметрФормыКонтрагента.Вставить("ЗначенияЗаполнения",СтруктураЗначенийЗаполнения);
	
	ПолучитьФорму("Справочник.Контрагенты.ФормаОбъекта", ПараметрФормыКонтрагента).Открыть();
	
КонецПроцедуры

&НаКлиенте
Процедура ДобавитьКонтактноеЛицо(Команда)
	
	ПараметрФормыКонтактногоЛица = Новый Структура;
	ПараметрФормыКонтактногоЛица.Вставить("Ключ", Неопределено);
	
	СтруктураЗначенийЗаполнения = Новый Структура;
	СтруктураЗначенийЗаполнения.Вставить("ПростыеЗвонки_НомерТелефона",НомерТелефона);
		
	ПараметрФормыКонтактногоЛица.Вставить("ЗначенияЗаполнения",СтруктураЗначенийЗаполнения);
	
	ПолучитьФорму("Справочник.КонтактныеЛицаПартнеров.ФормаОбъекта", ПараметрФормыКонтактногоЛица).Открыть();
	
КонецПроцедуры
